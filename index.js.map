{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '51577392-fe6fcec4f7e04f8f3d5104f81';\nconst MY_URL = 'https://pixabay.com/api/';\n\nexport default async function getImagesByQuery(query, page) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: '15',\n    page: page,\n  };\n\n  const response = await axios.get(MY_URL, { params });\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst showMoreBtn = document.querySelector('.show-more-btn');\nconst lightbox = new SimpleLightbox('.gallery .gallery-link', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  scrollZoom: false,\n});\n\nexport function createGallery(images) {\n  const markup = imagesTemplate(images);\n  galleryList.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryList.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.add('is-visible');\n}\n\nexport function hideLoader() {\n  loader.classList.remove('is-visible');\n}\n\nexport function showLoadMoreButton() {\n  showMoreBtn.classList.add('js-show-more');\n}\n\nexport function hideLoadMoreButton() {\n  showMoreBtn.classList.remove('js-show-more');\n}\n\nfunction imageTemplate(image) {\n  return `<li class=\"image-item\">\n        <a class='gallery-link' href='${image.largeImageURL}'>\n            <img src=\"${image.webformatURL}\" alt=\"${image.tags\n    .split(',')\n    .slice(0, 3)\n    .join(',')}\" class='image'/>\n        </a>\n        <div class=\"image-info\">\n          <p><span class='title'>Likes:</span><span class='counts'>${\n            image.likes\n          }</span></p>\n          <p><span class='title'>Views:</span><span class='counts'>${\n            image.views\n          }</span></p>\n          <p><span class='title'>Comments:</span><span class='counts'>${\n            image.comments\n          }</span></p>\n          <p><span class='title'>Downloads:</span><span class='counts'>${\n            image.downloads\n          }</span></p>\n        </div>\n      </li>`;\n}\n\nfunction imagesTemplate(images) {\n  return images.map(imageTemplate).join('');\n}\n","import getImagesByQuery from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst formElem = document.querySelector('.form');\nconst showMoreBtn = document.querySelector('.show-more-btn');\nconst scrollToTopBtn = document.querySelector('.scroll-to-top');\n\nlet page = 1;\nlet total = 0;\nconst imagePerPage = 15;\nlet searchQuery = '';\n\nformElem.addEventListener('submit', e => {\n  e.preventDefault();\n  const query = formElem.elements['search-text'].value.trim();\n  if (!query) {\n    iziToast.error({\n      message: 'Please enter a search query',\n      position: 'topRight',\n    });\n    return;\n  }\n  searchQuery = query;\n  page = 1;\n  handleSearch(query);\n});\n\nshowMoreBtn.addEventListener('click', () => {\n  showLoader();\n  getImagesByQuery(searchQuery, page)\n    .then(images => {\n      if (images.hits.length === 0) {\n        iziToast.error({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n        hideLoadMoreButton();\n        return;\n      }\n      createGallery(images.hits);\n      page++;\n      const card = document.querySelector('.gallery .image-item');\n      if (card) {\n        const cardHeight = card.getBoundingClientRect().height;\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: 'smooth',\n        });\n      }\n      if (page > Math.ceil(total / imagePerPage)) {\n        hideLoadMoreButton();\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    })\n    .catch(() => {\n      iziToast.error({\n        message: 'Error loading images',\n        position: 'topRight',\n      });\n    })\n    .finally(() => {\n      hideLoader();\n    });\n});\n\nfunction handleSearch(query) {\n  clearGallery();\n  hideLoadMoreButton();\n  showLoader();\n  getImagesByQuery(query, page)\n    .then(images => {\n      if (images.hits.length === 0) {\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n        hideLoadMoreButton();\n        return;\n      }\n      total = images.totalHits;\n      createGallery(images.hits);\n      page++;\n      if (page > Math.ceil(total / imagePerPage)) {\n        hideLoadMoreButton();\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      } else {\n        showLoadMoreButton();\n      }\n    })\n    .catch(() => {\n      iziToast.error({\n        message: 'Error loading images',\n        position: 'topRight',\n      });\n    })\n    .finally(() => {\n      hideLoader();\n    });\n}\n\nwindow.addEventListener('scroll', () => {\n  if (window.scrollY > 400) {\n    scrollToTopBtn.style.display = 'block';\n  } else {\n    scrollToTopBtn.style.display = 'none';\n  }\n});\n\nscrollToTopBtn.addEventListener('click', () => {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n});\n"],"names":["API_KEY","MY_URL","getImagesByQuery","query","page","params","axios","galleryList","loader","showMoreBtn","lightbox","SimpleLightbox","createGallery","images","markup","imagesTemplate","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","imageTemplate","image","formElem","scrollToTopBtn","total","imagePerPage","searchQuery","iziToast","handleSearch","card","cardHeight"],"mappings":"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"}